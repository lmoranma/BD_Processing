{"paragraphs":[{"text":"// 1. importar librerias sql\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.types.{StructType, StructField, StringType, IntegerType}","user":"anonymous","dateUpdated":"2020-02-04T21:22:28+0100","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.types.{StructType, StructField, StringType, IntegerType}\n"}]},"apps":[],"jobName":"paragraph_1580847748251_-33427592","id":"20200204-205220_348591478","dateCreated":"2020-02-04T21:22:28+0100","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:9824"},{"text":"// 2. Crear schema de la tabla\n\nval schema =new StructType().add(\"id\",IntegerType,true).add(\"nombre\",StringType,true).add(\"edad\",IntegerType,true).add(\"valor\",IntegerType,true)","user":"anonymous","dateUpdated":"2020-02-04T21:22:28+0100","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"schema: org.apache.spark.sql.types.StructType = StructType(StructField(id,IntegerType,true), StructField(nombre,StringType,true), StructField(edad,IntegerType,true), StructField(valor,IntegerType,true))\n"}]},"apps":[],"jobName":"paragraph_1580847748272_-1427405373","id":"20200204-205308_772707816","dateCreated":"2020-02-04T21:22:28+0100","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9825"},{"text":"//3. Subir dataset amigos\n\nval df =spark.read.format(\"csv\").schema(schema).option(\"delimiter\",\",\").load(\"/home/keepcoding/IdeaProjects/TestScalaNuevo/amigos.csv\")","user":"anonymous","dateUpdated":"2020-02-04T21:22:28+0100","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df: org.apache.spark.sql.DataFrame = [id: int, nombre: string ... 2 more fields]\n"}]},"apps":[],"jobName":"paragraph_1580847748272_440016017","id":"20200204-205351_785614408","dateCreated":"2020-02-04T21:22:28+0100","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9826"},{"text":"//4. Mostrarlo\n\ndf.show()","user":"anonymous","dateUpdated":"2020-02-04T21:22:28+0100","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+--------+----+-----+\n| id|  nombre|edad|valor|\n+---+--------+----+-----+\n|  0|    Will|  33|  385|\n|  1|Jean-Luc|  26|    2|\n|  2|    Hugh|  55|  221|\n|  3|  Deanna|  40|  465|\n|  4|   Quark|  68|   21|\n|  5|  Weyoun|  59|  318|\n|  6|  Gowron|  37|  220|\n|  7|    Will|  54|  307|\n|  8|  Jadzia|  38|  380|\n|  9|    Hugh|  27|  181|\n| 10|     Odo|  53|  191|\n| 11|     Ben|  57|  372|\n| 12|   Keiko|  54|  253|\n| 13|Jean-Luc|  56|  444|\n| 14|    Hugh|  43|   49|\n| 15|     Rom|  36|   49|\n| 16|  Weyoun|  22|  323|\n| 17|     Odo|  35|   13|\n| 18|Jean-Luc|  45|  455|\n| 19|  Geordi|  60|  246|\n+---+--------+----+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1580847748272_1470628970","id":"20200204-205434_1374694150","dateCreated":"2020-02-04T21:22:28+0100","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9827"},{"text":"// 5. Convertirlo en tabla\n\ndf.createOrReplaceTempView(\"amigos\")","user":"anonymous","dateUpdated":"2020-02-04T21:22:28+0100","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1580847748272_-1262782238","id":"20200204-205506_1733866482","dateCreated":"2020-02-04T21:22:28+0100","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9828"},{"text":"//6. Hacer la consulta para el conteo\n\nval consulta= spark.sql(\"select count(*) from amigos\")","user":"anonymous","dateUpdated":"2020-02-04T21:22:28+0100","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"consulta: org.apache.spark.sql.DataFrame = [count(1): bigint]\n"}]},"apps":[],"jobName":"paragraph_1580847748272_29738680","id":"20200204-205543_1748922715","dateCreated":"2020-02-04T21:22:28+0100","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9829"},{"text":"//7. Mostrar el resultado\n\nconsulta.show()","user":"anonymous","dateUpdated":"2020-02-04T21:22:28+0100","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+\n|count(1)|\n+--------+\n|     500|\n+--------+\n\n"}]},"apps":[],"jobName":"paragraph_1580847748272_1505539834","id":"20200204-205622_72192724","dateCreated":"2020-02-04T21:22:28+0100","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9830"},{"user":"anonymous","dateUpdated":"2020-02-04T21:22:28+0100","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1580847748272_387467666","id":"20200204-205700_387475688","dateCreated":"2020-02-04T21:22:28+0100","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9831"}],"name":"Practica procesamiento BD Laura","id":"2EZNRYAH8","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}